<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>115年度臺大醫療體系新進主治醫師與醫事人員研究營</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['"Noto Sans TC"', 'sans-serif'],
                    },
                    colors: {
                        primary: '#5e4a6f',
                        primaryHover: '#4a3a58',
                        secondary: '#8e7b9f',
                        accent: '#d3b4d3',
                        surface: '#ffffff',
                        background: '#f4f6f8',
                    },
                    boxShadow: {
                        'soft': '0 2px 8px rgba(0,0,0,0.04)',
                        'card': '0 2px 12px -2px rgba(0, 0, 0, 0.05)',
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #f4f6f8;
            color: #333333;
            -webkit-tap-highlight-color: transparent;
            font-family: 'Noto Sans TC', sans-serif;
            overflow-x: hidden;
        }
        
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(8px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-enter {
            animation: slideUp 0.3s ease-out forwards;
        }

        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        .pb-safe { padding-bottom: env(safe-area-inset-bottom); }
        .pt-safe { padding-top: env(safe-area-inset-top); }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo, useEffect } = React;

        // --- 資料來源: 議程 ---
        const AGENDA_DATA = [
          {
            date: "3月6日 (週五)",
            label: "Day 1",
            items: [
              { time: "08:00", endTime: "10:00", topic: "總院東址集合出發", location: "總院東址 -> 飯店", type: "logistic" },
              {
                section: "開幕與致詞",
                host: "林頌然 教授",
                items: [
                  { time: "10:00", endTime: "10:30", topic: "報到與開幕式", speaker: "全體人員" },
                  { time: "10:30", endTime: "11:00", topic: "院長室長官致詞 I", speaker: "高嘉宏 副院長", dept: "院長室" }
                ]
              },
              {
                section: "專題演講 I",
                host: "林頌然 教授",
                items: [
                  { time: "11:00", endTime: "11:30", topic: "醫師與醫事人員科學家之倫理素養", speaker: "蔡甫昌 主任", dept: "倫理中心" },
                  { time: "11:30", endTime: "12:00", topic: "讓教學被看見：臨床教師教學研究之路", speaker: "楊志偉 副主任", dept: "教學部" }
                ]
              },
              { time: "12:00", endTime: "13:30", topic: "午餐時間", location: "住宿大樓 2F 餐廳", type: "food" },
              {
                section: "專題演講 II",
                host: "楊鎧鍵 教授",
                items: [
                  { time: "13:30", endTime: "13:55", topic: "臨床與基礎研究的選擇", speaker: "林頌然 主任", dept: "醫學研究部" },
                  { time: "13:55", endTime: "14:20", topic: "個人研究與出國進修分享", speaker: "鐘桂彬 助理教授", dept: "檢驗醫學部" },
                  { time: "14:20", endTime: "14:45", topic: "如何發起及執行臨床試驗？", speaker: "劉志銘 教授", dept: "內科部" },
                  { time: "14:45", endTime: "15:10", topic: "透過生醫設計流程解決臨床問題", speaker: "黃博浩 副教授", dept: "外科部" },
                  { time: "15:10", endTime: "15:35", topic: "從站穩腳步到精益求精：個人永續發展之路", speaker: "陳慧玲 主任", dept: "教學部" },
                  { time: "15:35", endTime: "15:45", topic: "院長室長官致詞 II", speaker: "余忠仁 院長", dept: "院長室" }
                ]
              },
              { time: "15:45", endTime: "16:00", topic: "中場休息 (Coffee Break)", type: "break" },
              {
                section: "專題演講 III",
                title: "醫療結合研究的實踐與突破",
                host: "李宜家 教授",
                items: [
                  { time: "16:00", endTime: "16:20", topic: "護理部研究分享", speaker: "鄭靜宜 護理師", dept: "護理部" },
                  { time: "16:20", endTime: "16:40", topic: "檢驗醫學部研究分享", speaker: "陳怡婷 醫檢師", dept: "檢驗醫學部" },
                  { time: "16:40", endTime: "17:00", topic: "藥劑部研究分享", speaker: "林欣儀 藥師", dept: "藥劑部" },
                  { time: "17:00", endTime: "17:30", topic: "讓種子發光：總分院育苗計畫分享", speaker: "楊偉勛 教授、李志國 助理教授" }
                ]
              },
              { time: "17:30", endTime: "18:30", topic: "Check in 辦理住房", location: "飯店櫃檯", type: "logistic" },
              { time: "18:30", endTime: "20:30", topic: "歡迎晚宴", location: "宴會廳 (圓桌晚宴)", type: "food" }
            ]
          },
          {
            date: "3月7日 (週六)",
            label: "Day 2",
            items: [
              { time: "07:30", endTime: "09:00", topic: "早餐與自由活動", location: "住宿大樓 2F 餐廳", type: "food" },
              {
                section: "專題演講 IV",
                host: "楊鎧鍵 教授",
                items: [
                  { time: "09:00", endTime: "09:20", topic: "院內研究資源－共同研究室與研究服務核心", speaker: "蔡芷季 組長", dept: "醫學研究部" },
                  { time: "09:20", endTime: "09:40", topic: "院內計畫簡介懶人包", speaker: "楊鎧鍵 組長", dept: "醫學研究部" },
                  { time: "09:40", endTime: "10:00", topic: "使用醫療整合資料創新研發", speaker: "李宜家 副主任", dept: "醫學研究部" },
                  { time: "10:00", endTime: "11:00", topic: "生成式 AI 輔助研究懶人包", speaker: "莊又丞 資訊工程師", dept: "資訊室" },
                  { time: "11:00", endTime: "11:30", topic: "研究傳播工具：視覺化設計與可近用性評估", speaker: "張育瑄 主治醫師", dept: "教學部" }
                ]
              },
              { time: "11:30", endTime: "13:00", topic: "午餐時間", location: "住宿大樓 2F 餐廳", type: "food" },
              {
                section: "專題演講 V",
                host: "楊鎧鍵 教授",
                items: [
                  { time: "13:00", endTime: "13:30", topic: "主治醫師升等與經驗分享", speaker: "林孟暐 教授", dept: "外科部" },
                  { time: "13:30", endTime: "14:00", topic: "科研創新 × 專利思維：專利申請與技轉實務", speaker: "楊宗霖 副研發長", dept: "校總區研發處" }
                ]
              },
              {
                section: "綜合討論 & 閉幕",
                host: "林頌然 主任",
                items: [
                  { time: "14:00", endTime: "14:30", topic: "綜合討論 Q&A", speaker: "林頌然 主任 (引言)", dept: "醫學研究部" },
                  { time: "14:30", endTime: "15:00", topic: "閉幕、大合照與賦歸", speaker: "全體人員" }
                ]
              }
            ]
          }
        ];

        // --- 資料來源: 名冊 (預設測試資料) ---
        const INITIAL_ROSTER_DATA = [
          { category: "受邀長官", hospital: "總院", id: "002904", name: "余忠仁", dept: "院長室", title: "院長", bus: "自理", room: "不住宿", table: "主5", food: "不吃", diet: "葷", size: "L", extra_pay: "" },
          { category: "受邀長官", hospital: "總院", id: "002849", name: "高嘉宏", dept: "院長室", title: "副院長", bus: "自理", room: "不住宿", table: "不吃晚宴", food: "D1/不晚", diet: "葷", size: "L", extra_pay: "" },
          { category: "受邀講師", hospital: "總院", id: "007802", name: "李宜家", dept: "醫學研究部", title: "教授", bus: "B01", room: "C-12", table: "A-01", food: "D1/D2", diet: "葷", size: "XL", extra_pay: "3900" },
          { category: "參加學員", hospital: "新竹", id: "G04420", name: "黃亮恩", dept: "內科部", title: "主治醫師", bus: "B12", room: "C-21", table: "G-03", food: "D1/D2", diet: "葷", size: "L", extra_pay: "3900" },
          { category: "參加學員", hospital: "總院", id: "030405", name: "葉慧英", dept: "基因醫學部", title: "醫事檢驗師", bus: "C08", room: "A-02-2", table: "G-07", food: "D1/D2", diet: "素", size: "L", extra_pay: "" }
        ];

        // --- 資料來源: 線上課程 ---
        const COURSES_DATA = [
            { date: "115/01/29", topic: "生成式 AI 在生醫資料分析的應用", unit: "長庚大學資訊工程系", speaker: "李季青 副教授", tms: "200332" },
            { date: "114/10/02", topic: "加速研究，繁瑣的部分用開源工具搭配AI搞定", unit: "台大醫院資訊室", speaker: "莊又丞 資訊工程師", tms: "194653" },
            { date: "114/09/26", topic: "淺談AI世代的學術工具：從文獻回顧到分析撰寫", unit: "台大醫院教學部", speaker: "劉政亨 醫師", tms: "194460" },
            { date: "114/09/16", topic: "與AI共研未來：學術研究的資料搜尋、新素養與新倫理", unit: "臺灣大學圖書館", speaker: "范蔚敏 組員", tms: "193928" },
            { date: "114/04/15", topic: "論文寫作用AI：省力還是幫倒忙", unit: "台大醫院 醫學研究部", speaker: "黃舒宜 助理研究員", tms: "187276" }
        ];

        const JOURNAL_COURSES_DATA = [
            { date: "113/03/22", topic: "與期刊編輯面對面系列講座-How to publish with Nature Portfolio", unit: "Nature", speaker: "Laurie Dempsey", tms: "171553" },
            { date: "110/10/19", topic: "Open access與投稿期刊選擇", unit: "台大醫院醫學研究部", speaker: "黃舒宜 助理研究員", tms: "159013" },
            { date: "110/04/22", topic: "論文寫作新手村: 基本寫作技巧及常見問題解析", unit: "台大醫院醫學研究部", speaker: "黃舒宜 助理研究員", tms: "85232" }
        ];

        // --- 資料來源: 研究資源 ---
        const RESEARCHERS_DATA = [
            { name: "蔡芷季", title: "助理研究員（組長）", specialty: "分子生物學、生物化學", service: "負責督導實驗研究組與第二共同研究室管理，並管理基因定序暨生化核心及顯微影像核心", office: "第二共研" },
            { name: "林郁里", title: "院聘研究員", specialty: "生物化學、病毒免疫學", service: "負責第七共同研究室管理，支援免疫研究核心及小動物實驗核心", office: "第七共研" },
            { name: "莊雅婷", title: "院聘副研究員", specialty: "分子免疫學、細胞免疫學", service: "負責第三共同研究室管理及流式細胞分選暨分析核心", office: "第三共研" },
            { name: "張晉豪", title: "院聘副研究員", specialty: "生物統計學、流行病學", service: "提供臨床資料統計分析、臨床試驗與研究設計及收案諮詢，協助 REDCap 線上表單建置", office: "公衛大樓 8F" },
            { name: "黃舒宜", title: "院聘助理研究員", specialty: "細胞學、分子生物學", service: "提供英文論文寫作與投稿期刊評估諮詢，以及研究計畫寫作評估諮詢", office: "第六共研" },
            { name: "莊書琳", title: "院聘助理研究員", specialty: "流行病學、生物統計", service: "督導台大醫療體系整合資料庫，提供申請案件諮詢輔導、資料分析方法與研究設計建議", office: "公衛大樓 8F" }
        ];
        
        const RESEARCH_SERVICES_DATA = [
            { title: "論文與計畫諮詢", desc: "英文論文寫作評估、投稿期刊選擇、計畫書諮詢。AI浪潮席捲全球，論文不應是AI生成內容的拼貼，而要能反映作者的學術視角。本諮詢協助精準定位亮點。", icon: "FileText", offices: ["第六共研"] },
            { title: "生物統計與資料庫", desc: "臨床試驗設計、統計分析、醫療資料庫申請、數據處理", icon: "BarChart", offices: ["公衛大樓 8F"] },
            { title: "基因定序與生物資訊", desc: "次世代定序、高通量數據分析、系統生物學", icon: "Database", offices: ["第二共研"] },
            { title: "動物實驗模型", desc: "小動物實驗 (囓齒類、果蠅)、斑馬魚、疾病模型建立", icon: "Bug", offices: ["第二共研", "第七共研", "第八共研"] }
        ];

        // --- SVG 圖示 (Pure SVG with <g>) ---
        const Icon = ({ name, size = 20, className = "" }) => {
            const getIconContent = (iconName) => {
                switch (iconName) {
                    case 'Home': return (<g><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" /><polyline points="9 22 9 12 15 12 15 22" /></g>);
                    case 'Calendar': return (<g><rect width="18" height="18" x="3" y="4" rx="2" ry="2" /><line x1="16" x2="16" y1="2" y2="6" /><line x1="8" x2="8" y1="2" y2="6" /><line x1="3" x2="21" y1="10" y2="10" /></g>);
                    case 'Search': return (<g><circle cx="11" cy="11" r="8" /><path d="m21 21-4.3-4.3" /></g>);
                    case 'MapPin': return (<g><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z" /><circle cx="12" cy="10" r="3" /></g>);
                    case 'Clock': return (<g><circle cx="12" cy="12" r="10" /><polyline points="12 6 12 12 16 14" /></g>);
                    case 'User': return (<g><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2" /><circle cx="12" cy="7" r="4" /></g>);
                    case 'Users': return (<g><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2" /><circle cx="9" cy="7" r="4" /><path d="M22 21v-2a4 4 0 0 0-3-3.87" /><path d="M16 3.13a4 4 0 0 1 0 7.75" /></g>);
                    case 'ChevronDown': return <path d="m6 9 6 6 6-6" />;
                    case 'ChevronRight': return <path d="m9 18 6-6-6-6" />;
                    case 'Bus': return (<g><path d="M8 6v6" /><path d="M15 6v6" /><path d="M2 12h19.6" /><path d="M18 18h3s.5-1.7.8-2.8c.1-.4.2-.8.2-1.2 0-.4-.1-.8-.2-1.2l-1.4-5C20.1 6.8 19.1 6 18 6H4a2 2 0 0 0-2 2v10h3" /><circle cx="7" cy="18" r="2" /><path d="M9 18h5" /><circle cx="16" cy="18" r="2" /></g>);
                    case 'Bed': return (<g><path d="M2 4v16" /><path d="M2 8h18a2 2 0 0 1 2 2v10" /><path d="M2 17h20" /><path d="M6 8v9" /></g>);
                    case 'Utensils': return (<g><path d="M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2" /><path d="M7 2v20" /><path d="M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7" /></g>);
                    case 'FileText': return (<g><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z" /><polyline points="14 2 14 8 20 8" /><line x1="16" x2="8" y1="13" y2="13" /><line x1="16" x2="8" y1="17" y2="17" /><line x1="10" x2="8" y1="9" y2="9" /></g>);
                    case 'Camera': return (<g><path d="M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z" /><circle cx="12" cy="13" r="3" /></g>);
                    case 'ExternalLink': return (<g><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6" /><polyline points="15 3 21 3 21 9" /><line x1="10" x2="21" y1="14" y2="3" /></g>);
                    case 'Info': return (<g><circle cx="12" cy="12" r="10" /><line x1="12" x2="12" y1="16" y2="12" /><line x1="12" x2="12.01" y1="8" y2="8" /></g>);
                    case 'Star': return (<g><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></g>);
                    case 'Grid': return (<g><rect width="7" height="7" x="3" y="3" rx="1" /><rect width="7" height="7" x="14" y="3" rx="1" /><rect width="7" height="7" x="14" y="14" rx="1" /><rect width="7" height="7" x="3" y="14" rx="1" /></g>);
                    case 'Video': return (<g><path d="m22 8-6 4 6 4V8Z" /><rect width="14" height="12" x="2" y="6" rx="2" ry="2" /></g>);
                    case 'Beaker': return (<g><path d="M4.5 3h15" /><path d="M6 3v16a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V3" /><path d="M6 14h12" /></g>);
                    case 'BarChart': return (<g><line x1="18" x2="18" y1="20" y2="10" /><line x1="12" x2="12" y1="20" y2="4" /><line x1="6" x2="6" y1="20" y2="14" /></g>);
                    case 'Database': return (<g><ellipse cx="12" cy="5" rx="9" ry="3" /><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3" /><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5" /></g>);
                    case 'Bug': return (<g><path d="m8 2 1.88 1.88" /><path d="M14.12 3.88 16 2" /><path d="M9 7.13v-1a3.003 3.003 0 1 1 6 0v1" /><path d="M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6" /><path d="M12 20v-9" /><path d="M6.53 9C4.6 8.8 3 7.1 3 5" /><path d="M6 13H2" /><path d="M3 21c0-2.1 1.7-3.9 3.8-4" /><path d="M20.97 5c0 2.1-1.6 3.8-3.5 4" /><path d="M22 13h-4" /><path d="M17.2 17c2.1.1 3.8 1.9 3.8 4" /></g>);
                    case 'Layers': return (<g><polygon points="12 2 2 7 12 12 22 7 12 2" /><polyline points="2 17 12 22 22 17" /><polyline points="2 12 12 17 22 12" /></g>);
                    case 'Disc': return (<g><circle cx="12" cy="12" r="10" /><circle cx="12" cy="12" r="3" /></g>);
                    case 'Zap': return (<g><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2" /></g>);
                    case 'Activity': return (<g><polyline points="22 12 18 12 15 21 9 3 6 12 2 12" /></g>);
                    case 'Edit3': return (<g><path d="M12 20h9" /><path d="M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z" /></g>);
                    case 'Download': return (<g><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" /><polyline points="7 10 12 15 17 10" /><line x1="12" x2="12" y1="15" y2="3" /></g>);
                    case 'BookOpen': return (<g><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z" /><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z" /></g>);
                    default: return <circle cx="12" cy="12" r="10" />;
                }
            };

            return (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                    {getIconContent(name)}
                </svg>
            );
        };

        // --- 通用元件 ---
        const PlaceItem = ({ title, desc }) => {
            const mapUrl = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(title + " 宜蘭蘇澳")}`;
            return (
                <a href={mapUrl} target="_blank" rel="noopener noreferrer" className="flex justify-between items-center border-b border-gray-100 last:border-0 pb-3 last:pb-0 pt-2 hover:bg-gray-50 -mx-2 px-2 rounded-lg transition-colors cursor-pointer group">
                    <div className="flex-1 min-w-0 mr-3">
                        <div className="text-[15px] font-bold text-gray-800 truncate mb-0.5 group-hover:text-[#5e4a6f]">{title}</div>
                        <div className="text-xs text-gray-500 truncate">{desc}</div>
                    </div>
                    <div className="w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center text-gray-500 group-hover:bg-[#f4eff6] group-hover:text-[#5e4a6f] shrink-0 transition-colors">
                        <Icon name="MapPin" size={16} />
                    </div>
                </a>
            );
        };

        const CourseSection = ({ title, icon, courses, defaultExpanded = true }) => {
            const [expanded, setExpanded] = useState(defaultExpanded);
            return (
                <div className="bg-white rounded-2xl shadow-card border border-gray-100 overflow-hidden mb-4">
                    <div 
                        className="p-4 flex justify-between items-center cursor-pointer active:bg-gray-50 transition-colors"
                        onClick={() => setExpanded(!expanded)}
                    >
                        <div className="flex items-center gap-3">
                            <div className="w-10 h-10 rounded-full bg-[#f4eff6] text-[#5e4a6f] flex items-center justify-center">
                                <Icon name={icon} size={20} />
                            </div>
                            <h3 className="font-bold text-gray-800 text-[15px]">{title}</h3>
                        </div>
                        <div className={`text-gray-400 transition-transform duration-300 ${expanded ? 'rotate-180' : ''}`}>
                            <Icon name="ChevronDown" size={20} />
                        </div>
                    </div>
                    
                    <div className={`transition-all duration-300 ease-in-out ${expanded ? 'max-h-[3000px] opacity-100 border-t border-gray-100' : 'max-h-0 opacity-0'}`}>
                        <div className="p-4 space-y-4 bg-gray-50/50">
                            {courses.map((course, idx) => (
                                <div key={idx} className="bg-white rounded-xl shadow-sm border border-gray-200 p-4">
                                    <div className="flex justify-between items-start mb-2">
                                        <div className="text-xs font-bold text-[#5e4a6f] bg-[#f4eff6] px-2.5 py-1 rounded-md">{course.date}</div>
                                        {course.tms !== "無" && (
                                            <a href={`https://edu.ntuh.gov.tw/course/${course.tms}`} target="_blank" rel="noopener noreferrer" className="text-[11px] font-medium text-blue-600 bg-blue-50 px-2 py-1 rounded-md hover:bg-blue-100 transition-colors flex items-center gap-1">
                                                TMS {course.tms} <Icon name="ExternalLink" size={10} />
                                            </a>
                                        )}
                                    </div>
                                    <h4 className="font-bold text-gray-800 text-base mb-2 leading-relaxed">{course.topic}</h4>
                                    <div className="flex flex-col gap-1.5 mt-2 pt-2 border-t border-gray-100">
                                        <div className="flex items-center gap-2 text-xs text-gray-600">
                                            <Icon name="User" size={14} className="text-gray-400" />
                                            <span className="font-medium">{course.speaker}</span>
                                        </div>
                                        <div className="flex items-center gap-2 text-xs text-gray-500">
                                            <Icon name="MapPin" size={14} className="text-gray-400" />
                                            <span>{course.unit}</span>
                                        </div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );
        };

        // --- 頂部標題列 ---
        const TopBar = () => (
            <div className="bg-white sticky top-0 z-50 px-5 py-3.5 shadow-sm border-b border-gray-100 flex items-center justify-between">
                <div className="flex items-center gap-3">
                    <img src="https://i.meee.com.tw/AAiaMSR.png" alt="Logo" className="w-9 h-9 object-contain" />
                    <div className="flex flex-col">
                        <span className="text-[10px] text-gray-500 font-bold tracking-widest uppercase mb-0.5">臺大醫療體系</span>
                        <span className="text-[15px] font-bold text-[#5e4a6f] leading-none">115年度新進主治醫師與醫事人員研究營</span>
                    </div>
                </div>
            </div>
        );

        // --- 頁面: 首頁 ---
        const HomeView = ({ onChangeTab }) => (
            <div className="p-5 pt-6 pb-6 space-y-6 animate-enter">
                {/* Hero Block - 清爽明亮版 */}
                <div className="bg-[#5e4a6f] rounded-3xl p-6 text-white shadow-card relative overflow-hidden">
                    <div className="absolute top-0 right-0 w-32 h-32 bg-white rounded-full blur-[60px] opacity-10 -mr-10 -mt-10"></div>
                    
                    <div className="inline-flex items-center gap-1.5 px-3 py-1 bg-white/20 rounded-full text-xs font-bold mb-4 border border-white/20">
                        <Icon name="Star" size={14} /> 活動資訊
                    </div>
                    
                    <h2 className="text-2xl font-bold mb-6 leading-tight">
                        新進主治醫師與<br/><span className="text-[#d3b4d3]">醫事人員研究營</span>
                    </h2>
                    
                    <div className="bg-white/10 rounded-2xl p-4 space-y-3 backdrop-blur-sm border border-white/10">
                        <div className="flex items-start gap-3">
                            <div className="mt-0.5 text-[#d3b4d3]"><Icon name="Clock" size={18} /></div>
                            <div>
                                <div className="text-[11px] text-gray-300 font-bold tracking-wider mb-0.5">活動日期</div>
                                <div className="text-sm font-medium">115年3月6日 (五) ~ 3月7日 (六)</div>
                            </div>
                        </div>
                        <div className="h-px w-full bg-white/10"></div>
                        <div className="flex items-start gap-3">
                            <div className="mt-0.5 text-[#d3b4d3]"><Icon name="MapPin" size={18} /></div>
                            <div>
                                <div className="text-[11px] text-gray-300 font-bold tracking-wider mb-0.5">活動地點</div>
                                <a href="https://www.google.com/maps/search/?api=1&query=瓏山林蘇澳冷熱泉度假飯店" target="_blank" rel="noopener noreferrer" className="text-sm font-medium hover:text-[#d3b4d3] transition-colors flex items-center gap-1">
                                    瓏山林蘇澳冷熱泉度假飯店 <Icon name="ExternalLink" size={12} className="opacity-70"/>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                {/* 內部注意警示 */}
                <div className="bg-orange-50 border border-orange-100 rounded-2xl p-4 flex items-start gap-3 shadow-sm">
                    <div className="text-orange-500 bg-white p-1 rounded-full shadow-sm shrink-0"><Icon name="Shield" size={16} /></div>
                    <p className="text-xs text-orange-700 font-medium leading-relaxed mt-0.5">
                        此網頁含參訓學員個資，僅供院內相關人員閱覽，請勿外流。
                    </p>
                </div>

                {/* 主要按鈕區 (Primary Calls to Action) */}
                <div className="grid grid-cols-2 gap-3">
                    <button onClick={() => onChangeTab('agenda')} className="bg-white py-5 px-4 rounded-2xl shadow-card border border-gray-100 flex flex-col items-center justify-center gap-3 active:scale-[0.98] transition-all">
                        <div className="w-12 h-12 rounded-full bg-[#f4eff6] text-[#5e4a6f] flex items-center justify-center">
                            <Icon name="Calendar" size={24} />
                        </div>
                        <span className="font-bold text-gray-800 text-[15px]">查看議程</span>
                    </button>
                    <button onClick={() => onChangeTab('roster')} className="bg-[#5e4a6f] py-5 px-4 rounded-2xl shadow-card flex flex-col items-center justify-center gap-3 active:scale-[0.98] transition-all text-white">
                        <div className="w-12 h-12 rounded-full bg-white/20 flex items-center justify-center">
                            <Icon name="Search" size={24} />
                        </div>
                        <span className="font-bold text-[15px]">查詢名冊</span>
                    </button>
                </div>

                {/* 簡單聯絡資訊 */}
                <div className="bg-gray-100 rounded-2xl p-5 text-center">
                    <div className="text-xs font-bold text-gray-500 mb-2">主辦單位：台大醫院醫學研究部</div>
                    <div className="text-xs text-gray-400">承辦人：陳巧瑜管理師 (分機 263254)</div>
                </div>
            </div>
        );

        // --- 頁面: 議程 ---
        const AgendaView = () => {
            const [day, setDay] = useState(0);
            return (
                <div className="animate-enter min-h-screen bg-[#f8f9fc]">
                    {/* 清爽型 Tab 切換 */}
                    <div className="sticky top-[64px] z-40 bg-[#f8f9fc]/95 backdrop-blur-md px-5 py-3">
                        <div className="flex bg-gray-200/70 p-1 rounded-xl shadow-inner">
                            {AGENDA_DATA.map((d, i) => (
                                <button 
                                    key={i} 
                                    onClick={() => setDay(i)} 
                                    className={`flex-1 py-2.5 rounded-lg text-sm font-bold transition-all duration-200 flex flex-col items-center justify-center leading-tight ${day === i ? 'bg-white text-[#5e4a6f] shadow-sm' : 'text-gray-500 hover:text-gray-700'}`}
                                >
                                    <span>{d.label}</span>
                                    <span className={`text-[10px] ${day === i ? 'text-gray-500 font-medium' : 'font-normal opacity-70'}`}>{d.date}</span>
                                </button>
                            ))}
                        </div>
                    </div>

                    <div className="px-5 py-2 pb-6 space-y-4">
                        {AGENDA_DATA[day].items.map((item, index) => (
                            <AgendaItem key={index} block={item} isLast={index === AGENDA_DATA[day].items.length - 1} />
                        ))}
                    </div>
                </div>
            );
        };

        const AgendaItem = ({ block, isLast }) => {
            const [expanded, setExpanded] = useState(false);
            
            // 實心線條時間軸
            const Dot = () => (
                <div className="flex flex-col items-center mr-4 w-4 shrink-0">
                    <div className={`w-3 h-3 rounded-full mt-1.5 ${block.section ? 'bg-[#5e4a6f] ring-4 ring-[#f4eff6]' : 'bg-gray-300'}`}></div>
                    {!isLast && <div className="w-0.5 flex-1 bg-gray-200 mt-2 rounded-full"></div>}
                </div>
            );

            if (block.section) {
                return (
                    <div className="flex">
                        <Dot />
                        <div className="flex-1 pb-4">
                            <div className="bg-white rounded-2xl shadow-card border border-gray-100 overflow-hidden">
                                <div className="p-4 active:bg-gray-50 transition-colors cursor-pointer" onClick={() => setExpanded(!expanded)}>
                                    <div className="flex justify-between items-start mb-2">
                                        <span className="text-[10px] font-bold text-white bg-[#5e4a6f] px-2 py-0.5 rounded-md tracking-wider">專題演講</span>
                                        <Icon name={expanded ? "ChevronUp" : "ChevronDown"} size={18} className="text-gray-400" />
                                    </div>
                                    <h3 className="font-bold text-gray-800 text-[17px] mb-1.5 leading-snug">{block.section}</h3>
                                    {block.title && <p className="text-sm text-gray-600 mb-2 font-medium">{block.title}</p>}
                                    <div className="inline-flex items-center gap-1.5 bg-gray-50 px-2.5 py-1 rounded-lg text-xs font-medium text-gray-600">
                                        <Icon name="User" size={14} className="text-gray-400"/> 主持：{block.host}
                                    </div>
                                </div>
                                
                                {/* 展開內容 */}
                                <div className={`bg-gray-50/50 border-t border-gray-100 transition-all duration-300 ease-in-out ${expanded ? 'max-h-[1000px] opacity-100' : 'max-h-0 opacity-0 overflow-hidden'}`}>
                                    <div className="p-4 space-y-4">
                                        {block.items.map((sub, idx) => (
                                            <div key={idx} className="bg-white p-3 rounded-xl border border-gray-100 shadow-sm">
                                                <div className="text-xs font-bold text-[#5e4a6f] mb-1">{sub.time} - {sub.endTime}</div>
                                                <div className="text-[15px] font-bold text-gray-800 mb-1.5 leading-snug">{sub.topic}</div>
                                                {sub.speaker && (
                                                    <div className="text-xs text-gray-500 font-medium">
                                                        {sub.speaker} {sub.dept && <span className="text-gray-400">({sub.dept})</span>}
                                                    </div>
                                                )}
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }

            // 一般行程
            let iconName = "Clock"; 
            let bgColor = "bg-white";
            let textColor = "text-gray-700";
            let iconBox = "bg-gray-100 text-gray-500";
            
            if (block.type === 'food') { iconName = "Utensils"; iconBox = "bg-orange-50 text-orange-500"; }
            if (block.type === 'logistic') { iconName = "Bus"; iconBox = "bg-blue-50 text-blue-500"; }
            if (block.type === 'break') { bgColor = "bg-transparent border-none shadow-none px-0 py-2"; textColor="text-gray-500"; iconBox="bg-transparent text-gray-400 p-0"; }

            return (
                <div className="flex">
                    <Dot />
                    <div className={`flex-1 pb-4`}>
                        <div className={`${bgColor} ${block.type !== 'break' ? 'rounded-2xl shadow-sm border border-gray-100 p-4' : ''} flex gap-4 items-center`}>
                            <div className={`w-10 h-10 rounded-full flex items-center justify-center shrink-0 ${iconBox}`}>
                                <Icon name={iconName} size={20} />
                            </div>
                            <div className="flex-1 min-w-0">
                                <div className={`font-bold text-[15px] truncate mb-0.5 ${textColor}`}>{block.topic}</div>
                                <div className="text-xs font-bold text-gray-400">{block.time} {block.endTime && `- ${block.endTime}`}</div>
                                {block.location && (
                                    <div className="text-xs text-gray-500 flex items-center gap-1 mt-1 truncate">
                                        <Icon name="MapPin" size={12} className="shrink-0" /> {block.location}
                                    </div>
                                )}
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // --- 頁面: 名冊 ---
        const RosterView = () => {
            const [search, setSearch] = useState("");
            const [tab, setTab] = useState("all");
            const [rosterData, setRosterData] = useState([]);
            const [loading, setLoading] = useState(true);

            useEffect(() => {
                fetch('https://script.google.com/macros/s/AKfycbzFO8lChUB9zL0nJY3nOXT2TSP_rTpsnIci1C-1dtYUeKMeOfBhzsEJW1MSbEOWuOBP9Q/exec')
                    .then(res => res.json())
                    .then(data => {
                         setRosterData(data);
                         setLoading(false);
                    })
                    .catch(err => {
                        console.error('Failed to fetch roster:', err);
                        setLoading(false);
                        setRosterData(INITIAL_ROSTER_DATA); 
                    });
            }, []);

            const filtered = useMemo(() => {
                let res = rosterData;
                if (tab === 'accommodation') {
                    res = res.filter(p => p.room && p.room !== '不住宿' && p.room !== '');
                    res.sort((a, b) => a.room.localeCompare(b.room));
                }
                if (search) {
                    const lower = search.toLowerCase();
                    res = res.filter(p => p.name.includes(search) || p.id.includes(search) || (p.dept && p.dept.includes(search)));
                }
                return res;
            }, [search, tab, rosterData]);

            return (
                <div className="pb-6 pt-16 animate-enter min-h-screen">
                    <div className="sticky top-[64px] z-30 bg-[#f8f9fc] px-5 py-2">
                        {/* 實體搜尋框 */}
                        <div className="relative mb-3">
                            <div className="absolute left-4 top-3.5 text-gray-400"><Icon name="Search" size={20} /></div>
                            <input 
                                type="text" 
                                placeholder="搜尋姓名、員工編號、單位(點人名可看詳細)..." 
                                className="w-full pl-11 pr-4 py-3.5 rounded-xl border border-gray-200 bg-white focus:border-[#5e4a6f] focus:ring-1 focus:ring-[#5e4a6f] outline-none text-[15px] transition-all placeholder-gray-400 shadow-sm" 
                                value={search} 
                                onChange={e => setSearch(e.target.value)} 
                            />
                        </div>
                        
                        {/* 藥丸型過濾按鈕 */}
                        <div className="flex gap-2">
                            <button onClick={() => setTab('all')} className={`flex-1 py-2 text-sm font-bold rounded-lg border transition-all ${tab === 'all' ? 'bg-[#5e4a6f] text-white border-[#5e4a6f]' : 'bg-white text-gray-500 border-gray-200 active:bg-gray-50'}`}>全部名冊</button>
                            <button onClick={() => setTab('accommodation')} className={`flex-1 py-2 text-sm font-bold rounded-lg border transition-all ${tab === 'accommodation' ? 'bg-[#5e4a6f] text-white border-[#5e4a6f]' : 'bg-white text-gray-500 border-gray-200 active:bg-gray-50'}`}>住宿名單</button>
                        </div>
                    </div>

                    <div className="px-5 space-y-3 mt-3 pb-6">
                        {loading ? (
                            <div className="flex flex-col justify-center items-center py-20 gap-3">
                                <div className="w-8 h-8 border-4 border-gray-200 border-t-[#5e4a6f] rounded-full animate-spin"></div>
                                <p className="text-gray-400 text-sm font-medium animate-pulse tracking-wide">載入資料中...</p>
                            </div>
                        ) : (
                            <>
                                <div className="text-xs font-bold text-gray-400 mb-2 pl-1">共 {filtered.length} 筆資料</div>
                                {filtered.map((p, i) => <RosterCard key={i} person={p} />)}
                                {filtered.length === 0 && (
                                    <div className="text-center py-16">
                                        <div className="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-3 text-gray-300"><Icon name="Search" size={32} /></div>
                                        <p className="text-gray-500 font-medium text-sm">沒有找到符合的資料</p>
                                    </div>
                                )}
                            </>
                        )}
                    </div>
                </div>
            );
        };

        const RosterCard = ({ person }) => {
            const [expanded, setExpanded] = useState(false);
            return (
                <div className="bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden transition-all duration-200">
                    <div className="p-4 cursor-pointer active:bg-gray-50" onClick={() => setExpanded(!expanded)}>
                        <div className="flex justify-between items-start mb-3">
                            <div>
                                <h3 className="font-bold text-gray-800 text-lg flex items-center gap-2 mb-1">
                                    {person.name}
                                    <span className="text-[10px] font-bold bg-gray-100 text-gray-500 px-2 py-0.5 rounded-md">{person.title}</span>
                                </h3>
                                <p className="text-xs text-gray-500 font-medium">{person.hospital} • {person.dept}</p>
                            </div>
                            <div className="flex flex-col gap-1.5 items-end">
                                {person.diet !== '葷' && <span className="text-[10px] font-bold text-green-700 bg-green-50 border border-green-200 px-2 py-0.5 rounded-md">素食</span>}
                                {person.extra_pay && <span className="text-[10px] font-bold text-red-600 bg-red-50 border border-red-200 px-2 py-0.5 rounded-md">補差額</span>}
                            </div>
                        </div>
                        
                        <div className="grid grid-cols-3 gap-2">
                            <InfoPill icon="Bus" label="交通" value={person.bus} />
                            <InfoPill icon="Bed" label="房號" value={person.room} highlight={person.room !== '不住宿'} />
                            <InfoPill icon="Utensils" label="晚宴" value={person.table} highlight={person.table !== '不吃晚宴'}/>
                        </div>
                    </div>

                    {/* 詳細資料展開 */}
                    <div className={`bg-gray-50/80 border-t border-gray-100 transition-all duration-300 ease-in-out ${expanded ? 'max-h-[500px] opacity-100' : 'max-h-0 opacity-0 overflow-hidden'}`}>
                        <div className="p-4 grid grid-cols-2 gap-y-3 gap-x-4 text-sm">
                            <DetailRow label="員工編號" value={person.id} />
                            <DetailRow label="身分類別" value={person.category} />
                            <DetailRow label="晚宴桌次" value={person.table} highlight />
                            <DetailRow label="衣服尺寸" value={person.size} />
                            {person.extra_pay && <div className="col-span-2 text-red-600 font-bold bg-white border border-red-100 p-2.5 rounded-xl text-center mt-1 shadow-sm">需補差額：${person.extra_pay}</div>}
                        </div>
                    </div>
                </div>
            );
        };

        const InfoPill = ({ icon, label, value, highlight }) => (
            <div className={`px-2 py-2 rounded-xl flex flex-col items-center justify-center text-center ${highlight ? 'bg-[#f4eff6]' : 'bg-gray-50'}`}>
                <Icon name={icon} size={16} className={`mb-1 ${highlight ? 'text-[#5e4a6f]' : 'text-gray-400'}`} />
                <span className="text-[10px] text-gray-500 mb-0.5">{label}</span>
                <span className={`text-xs font-bold truncate w-full ${highlight ? 'text-[#5e4a6f]' : 'text-gray-700'}`}>{value}</span>
            </div>
        );

        const DetailRow = ({ label, value, highlight }) => (
            <div className="flex flex-col gap-0.5">
                <span className="text-[11px] text-gray-500 font-medium">{label}</span>
                <span className={`font-bold text-[14px] ${highlight ? 'text-[#5e4a6f]' : 'text-gray-800'}`}>{value}</span>
            </div>
        );

        // --- 頁面: 行前 ---
        const PreTripView = () => (
            <div className="p-5 pt-20 pb-6 animate-enter space-y-4">
                <InfoCard icon="Info" title="注意事項">
                    <ul className="list-disc list-outside ml-5 space-y-2 text-sm text-gray-600 leading-relaxed marker:text-gray-300">
                        <li>請攜帶健保卡、個人隨身藥品與個人盥洗備品。</li>
                        <li>飯店提供冷熱泉設施，請自備泳衣泳帽。</li>
                        <li>課程期間請將手機轉為靜音，會場提供充電與Wifi。</li>
                        <li>3月份宜蘭氣候多變，請攜帶雨具及保暖衣物。</li>
                        <li>院方核准公假受訓，上課與結訓須依規定簽到退。</li>
                    </ul>
                </InfoCard>

                <InfoCard icon="Bus" title="行車宣導">
                    <ul className="list-disc list-outside ml-5 space-y-2 text-sm text-gray-600 leading-relaxed marker:text-gray-300">
                        <li>請依車次搭乘，下於車上發放房卡與行李吊牌。</li>
                        <li>回程人滿即發車，下車點依當日路況而定。</li>
                    </ul>
                </InfoCard>

                <InfoCard icon="FileText" title="差假規定">
                    <div className="space-y-3 text-sm text-gray-600">
                        <div className="bg-gray-50 p-3.5 rounded-xl border border-gray-100">
                            <span className="font-bold block text-gray-800 mb-1">1. 上班時間受訓</span>
                            參訓人員受訓期間如遇上班時間，依規定核予公假前往。
                        </div>
                        <div className="bg-gray-50 p-3.5 rounded-xl border border-gray-100">
                            <span className="font-bold block text-gray-800 mb-1">2. 非上班時間受訓</span>
                            如於非上班時間受訓則以實際參訓時數辦理公假補休。
                        </div>
                    </div>
                </InfoCard>
            </div>
        );

        const InfoCard = ({ icon, title, children }) => (
            <div className="bg-white rounded-2xl shadow-card border border-gray-100 p-5">
                <div className="flex items-center gap-3 mb-4 pb-3 border-b border-gray-100">
                    <div className="w-8 h-8 rounded-full bg-[#f4eff6] text-[#5e4a6f] flex items-center justify-center">
                        <Icon name={icon} size={18} />
                    </div>
                    <h3 className="font-bold text-gray-800 text-[17px]">{title}</h3>
                </div>
                {children}
            </div>
        );

        // --- 頁面: 會後 ---
        const PostTripView = () => (
            <div className="p-5 pt-20 pb-6 animate-enter space-y-4">
                {/* 簽到退 */}
                <div className="bg-white rounded-2xl shadow-card border border-gray-200 p-5 flex items-center justify-between active:scale-[0.98] transition-transform">
                    <div className="flex items-center gap-4">
                        <div className="w-12 h-12 rounded-full bg-blue-50 text-blue-600 flex items-center justify-center shrink-0">
                            <Icon name="Edit3" size={24} />
                        </div>
                        <div>
                            <h4 className="font-bold text-gray-800 text-base mb-0.5">活動線上簽到退</h4>
                            <p className="text-xs text-gray-500">請依規定時間完成</p>
                        </div>
                    </div>
                    <a href="https://medresearchntuh.github.io/2026030607_115ntuhcampsign/" target="_blank" className="px-4 py-2 bg-blue-600 text-white text-sm font-bold rounded-xl shadow-sm hover:bg-blue-700 transition-colors whitespace-nowrap">
                        前往簽到
                    </a>
                </div>

                {/* 滿意度調查 */}
                <div className="bg-white rounded-2xl shadow-card border border-gray-200 p-5 flex items-center justify-between active:scale-[0.98] transition-transform">
                    <div className="flex items-center gap-4">
                        <div className="w-12 h-12 rounded-full bg-[#f4eff6] text-[#5e4a6f] flex items-center justify-center shrink-0">
                            <Icon name="FileText" size={24} />
                        </div>
                        <div>
                            <h4 className="font-bold text-gray-800 text-base mb-0.5">活動滿意度調查</h4>
                            <p className="text-xs text-gray-500">協助我們辦得更好</p>
                        </div>
                    </div>
                    <a href="https://medresearchntuh.github.io/20260307_115ntuhcampsurvey/" target="_blank" className="px-4 py-2 bg-[#5e4a6f] text-white text-sm font-bold rounded-xl shadow-sm hover:bg-primaryHover transition-colors whitespace-nowrap">
                        前往填寫
                    </a>
                </div>

                {/* 檔案下載 Grid */}
                <div className="grid grid-cols-2 gap-3 pt-2">
                    <div className="bg-white rounded-2xl shadow-card p-5 border border-gray-100 flex flex-col items-center text-center">
                        <div className="w-12 h-12 bg-gray-50 rounded-full flex items-center justify-center mb-3 text-gray-600 border border-gray-100">
                            <Icon name="Camera" size={22} />
                        </div>
                        <h4 className="font-bold text-gray-800 text-sm mb-1">活動照片下載</h4>
                        <p className="text-[10px] text-gray-400 mb-3">2周工作天上傳</p>
                        <button disabled className="w-full py-2 bg-gray-100 text-gray-400 rounded-lg text-xs font-bold cursor-not-allowed">
                            尚未開放
                        </button>
                    </div>

                    <div className="bg-white rounded-2xl shadow-card p-5 border border-gray-100 flex flex-col items-center text-center">
                        <div className="w-12 h-12 bg-gray-50 rounded-full flex items-center justify-center mb-3 text-gray-600 border border-gray-100">
                            <Icon name="BookOpen" size={22} />
                        </div>
                        <h4 className="font-bold text-gray-800 text-sm mb-1">活動講義下載</h4>
                        <p className="text-[10px] text-gray-400 mb-3">2周工作天上傳</p>
                        <button disabled className="w-full py-2 bg-gray-100 text-gray-400 rounded-lg text-xs font-bold cursor-not-allowed">
                            尚未開放
                        </button>
                    </div>
                </div>
            </div>
        );

        // --- 頁面: 資源 ---
        const ResourcesView = () => {
            const [subTab, setSubTab] = useState('research'); // research, courses, suao
            const [researchSubTab, setResearchSubTab] = useState('services'); // services, researchers

            return (
                <div className="pb-6 pt-16 animate-enter min-h-screen">
                    <div className="sticky top-[64px] z-30 bg-[#f8f9fc]/95 backdrop-blur-md px-5 py-3">
                        <div className="flex bg-gray-200/70 p-1 rounded-xl shadow-inner mb-3">
                            <button onClick={() => setSubTab('research')} className={`flex-1 py-2 text-sm font-bold rounded-lg transition-all ${subTab === 'research' ? 'bg-white text-[#5e4a6f] shadow-sm' : 'text-gray-500'}`}>院內研究</button>
                            <button onClick={() => setSubTab('courses')} className={`flex-1 py-2 text-sm font-bold rounded-lg transition-all ${subTab === 'courses' ? 'bg-white text-[#5e4a6f] shadow-sm' : 'text-gray-500'}`}>線上課程</button>
                            <button onClick={() => setSubTab('suao')} className={`flex-1 py-2 text-sm font-bold rounded-lg transition-all ${subTab === 'suao' ? 'bg-white text-[#5e4a6f] shadow-sm' : 'text-gray-500'}`}>蘇澳觀光</button>
                        </div>
                        
                        {subTab === 'research' && (
                            <div className="flex justify-center">
                                <div className="inline-flex bg-gray-200/50 p-1 rounded-lg">
                                    <button 
                                        onClick={() => setResearchSubTab('services')} 
                                        className={`px-5 py-1.5 text-xs font-bold rounded-md transition-all ${researchSubTab === 'services' ? 'bg-white text-[#5e4a6f] shadow-sm' : 'text-gray-500'}`}
                                    >
                                        研究服務
                                    </button>
                                    <button 
                                        onClick={() => setResearchSubTab('researchers')} 
                                        className={`px-5 py-1.5 text-xs font-bold rounded-md transition-all ${researchSubTab === 'researchers' ? 'bg-white text-[#5e4a6f] shadow-sm' : 'text-gray-500'}`}
                                    >
                                        共研研究員
                                    </button>
                                </div>
                            </div>
                        )}
                    </div>

                    <div className="px-5 pb-6">
                        {subTab === 'research' && (
                            <div className="animate-enter space-y-3">
                                {researchSubTab === 'services' ? (
                                    RESEARCH_SERVICES_DATA.map((srv, idx) => (
                                        <div key={idx} className="bg-white rounded-2xl shadow-sm border border-gray-200 p-4 flex items-start gap-4">
                                            <div className="w-10 h-10 bg-[#f4eff6] rounded-full text-[#5e4a6f] flex items-center justify-center shrink-0">
                                                <Icon name={srv.icon} size={20} />
                                            </div>
                                            <div>
                                                <h4 className="font-bold text-gray-800 text-[15px] mb-1.5 leading-snug">{srv.title}</h4>
                                                <p className="text-xs text-gray-500 leading-relaxed mb-3">{srv.desc}</p>
                                                <div className="flex flex-wrap gap-1.5">
                                                    {srv.offices.map((off, k) => (
                                                        <span key={k} className="text-[10px] font-bold bg-gray-100 text-gray-600 px-2 py-1 rounded-md">{off}</span>
                                                    ))}
                                                </div>
                                            </div>
                                        </div>
                                    ))
                                ) : (
                                    RESEARCHERS_DATA.map((researcher, idx) => (
                                        <div key={idx} className="bg-white rounded-2xl shadow-sm border border-gray-200 p-4">
                                            <div className="flex items-center gap-3 mb-3 pb-3 border-b border-gray-50">
                                                <div className="w-10 h-10 bg-[#f4eff6] rounded-full flex items-center justify-center text-[#5e4a6f] font-bold text-lg border border-[#f4eff6]">
                                                    {researcher.name[0]}
                                                </div>
                                                <div>
                                                    <a 
                                                        href="https://www.ntuh.gov.tw/LARD/Fpage.action?muid=5826&fid=6344" 
                                                        target="_blank" 
                                                        rel="noopener noreferrer"
                                                        className="font-bold text-[17px] text-gray-800 hover:text-[#5e4a6f] transition-colors flex items-center gap-1.5"
                                                    >
                                                        {researcher.name} <Icon name="ExternalLink" size={14} className="text-gray-400" />
                                                    </a>
                                                    <div className="text-[11px] font-bold text-gray-500">{researcher.title}</div>
                                                </div>
                                            </div>
                                            <div className="space-y-2">
                                                <div className="flex items-start gap-2 text-xs">
                                                    <span className="font-bold text-[#8e7b9f] shrink-0 w-10">專長</span>
                                                    <span className="text-gray-600">{researcher.specialty}</span>
                                                </div>
                                                <div className="flex items-start gap-2 text-xs">
                                                    <span className="font-bold text-gray-400 shrink-0 w-10">服務</span>
                                                    <span className="text-gray-500">{researcher.service}</span>
                                                </div>
                                                <div className="flex items-center gap-1 mt-2 text-xs font-bold text-gray-400 bg-gray-50 w-fit px-2 py-1 rounded-md border border-gray-100">
                                                    <Icon name="MapPin" size={12} /> {researcher.office}
                                                </div>
                                            </div>
                                        </div>
                                    ))
                                )}
                            </div>
                        )}

                        {subTab === 'courses' && (
                            <div className="animate-enter space-y-4">
                                <CourseSection 
                                    title="生成式 AI 輔助寫作課程" 
                                    icon="Video" 
                                    courses={COURSES_DATA} 
                                    defaultExpanded={true}
                                />
                                <CourseSection 
                                    title="論文與期刊投稿" 
                                    icon="FileText" 
                                    courses={JOURNAL_COURSES_DATA} 
                                    defaultExpanded={false} 
                                />
                            </div>
                        )}

                        {subTab === 'suao' && (
                            <div className="animate-enter space-y-5">
                                {/* 懶人包卡片 */}
                                <div className="bg-gradient-to-br from-[#5e4a6f] to-[#8e7b9f] rounded-3xl p-6 text-white shadow-card relative overflow-hidden">
                                    <div className="absolute top-0 right-0 w-32 h-32 bg-white rounded-full blur-[50px] opacity-10"></div>
                                    <h3 className="font-bold text-xl mb-3 flex items-center gap-2 relative z-10">
                                        <Icon name="Star" size={20} className="text-yellow-300" /> 蘇澳一日遊
                                    </h3>
                                    <p className="text-sm text-white/90 leading-relaxed relative z-10 font-medium">
                                        體驗全球唯二的冷泉，走訪粉鳥林、內埤情人灣等絕美海景，並大啖番割田甕缸雞、南方澳新鮮海鮮。推薦順遊蠟筆城堡、計程車博物館等親子觀光工廠。
                                    </p>
                                    <div className="mt-4 pt-4 border-t border-white/20 flex items-center gap-2 text-xs text-white/80 relative z-10 font-bold">
                                        <Icon name="Bus" size={16} /> 建議交通：火車至蘇澳站或客運至蘇澳服務區
                                    </div>
                                </div>

                                {/* 景點清單 */}
                                <div className="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
                                    <div className="bg-gray-50 px-4 py-3 border-b border-gray-100 flex items-center gap-2">
                                        <Icon name="Utensils" size={18} className="text-orange-500" />
                                        <h3 className="font-bold text-gray-800">精選美食</h3>
                                    </div>
                                    <div className="p-4 space-y-1">
                                        <PlaceItem title="番割田甕缸雞" desc="號稱宜蘭最好吃，交流道旁" />
                                        <PlaceItem title="阿芬鮮魚湯" desc="南方澳知名新鮮魚湯" />
                                        <PlaceItem title="海珍活海鮮餐廳" desc="漁港道地熱炒" />
                                        <PlaceItem title="南方澳無名蝦餅蚵嗲" desc="酥脆排隊蝦餅" />
                                        <PlaceItem title="義珍香烘焙坊" desc="爆漿饅頭、吐司" />
                                    </div>
                                </div>

                                <div className="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
                                    <div className="bg-gray-50 px-4 py-3 border-b border-gray-100 flex items-center gap-2">
                                        <Icon name="Camera" size={18} className="text-green-500" />
                                        <h3 className="font-bold text-gray-800">必訪景點</h3>
                                    </div>
                                    <div className="p-4 space-y-1">
                                        <PlaceItem title="粉鳥林秘境" desc="夢幻藍寶石海灣" />
                                        <PlaceItem title="內埤海灘情人灣" desc="絕美沙灘，適合看海放空" />
                                        <PlaceItem title="南方澳觀景台" desc="俯瞰南方澳漁港全景" />
                                        <PlaceItem title="蘇澳冷泉公園" desc="世界奇泉，夏天消暑" />
                                        <PlaceItem title="蜡藝蠟筆城堡" desc="彩繪DIY，親子熱門" />
                                        <PlaceItem title="計程車博物館" desc="主題特色博物館" />
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        // --- 主程式 & 底部實體導航 ---
        const App = () => {
            const [tab, setTab] = useState('home');

            return (
                <div className="min-h-screen bg-[#f8f9fc] font-sans text-[#333333] pb-24">
                    <TopBar />
                    
                    <main className="max-w-md mx-auto relative">
                        {tab === 'home' && <HomeView onChangeTab={setTab} />}
                        {tab === 'pre' && <PreTripView />}
                        {tab === 'agenda' && <AgendaView />}
                        {tab === 'roster' && <RosterView />}
                        {tab === 'post' && <PostTripView />}
                        {tab === 'resources' && <ResourcesView />}
                    </main>

                    {/* 頁尾資訊 */}
                    <footer className="max-w-md mx-auto text-center text-[11px] text-gray-400 pb-8 pt-4 font-medium">
                        系統設計：台大醫院總院醫學研究部 陳巧瑜管理師
                    </footer>

                    {/* Solid Bottom Navigation Bar */}
                    <div className="fixed bottom-0 left-0 right-0 z-50 bg-white border-t border-gray-200 pb-safe shadow-[0_-4px_10px_rgba(0,0,0,0.03)]">
                        <nav className="max-w-md mx-auto flex justify-between items-center px-2 py-1.5 h-[64px]">
                            <NavButton active={tab === 'home'} onClick={() => setTab('home')} icon="Home" label="首頁" />
                            <NavButton active={tab === 'pre'} onClick={() => setTab('pre')} icon="Info" label="行前" />
                            <NavButton active={tab === 'agenda'} onClick={() => setTab('agenda')} icon="Calendar" label="議程" />
                            <NavButton active={tab === 'roster'} onClick={() => setTab('roster')} icon="Search" label="名冊" />
                            <NavButton active={tab === 'post'} onClick={() => setTab('post')} icon="Download" label="會後" />
                            <NavButton active={tab === 'resources'} onClick={() => setTab('resources')} icon="Grid" label="資源" />
                        </nav>
                    </div>
                </div>
            );
        };

        const NavButton = ({ active, onClick, icon, label }) => (
            <button 
                onClick={onClick} 
                className={`flex flex-col items-center justify-center w-[16%] h-12 rounded-xl transition-all duration-200 ${active ? 'bg-[#f4eff6] text-[#5e4a6f]' : 'text-gray-400 hover:bg-gray-50'}`}
            >
                <div className={`transition-transform duration-200 ${active ? 'scale-110 mb-0.5' : 'scale-100'}`}>
                    <Icon name={icon} size={active ? 22 : 20} />
                </div>
                <span className={`text-[10px] ${active ? 'font-bold' : 'font-medium'}`}>{label}</span>
            </button>
        );

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>


