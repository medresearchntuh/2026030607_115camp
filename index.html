<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>115å¹´åº¦å°å¤§ç ”ç©¶ç‡Ÿæ´»å‹•App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root {
            --primary: #5e4a6f;    /* è³ªæ„Ÿæ·±ç´« */
            --secondary: #534a55;  /* æ·±è—•è‰² */
            --accent-light: #d3b4d3; /* æ·ºç²‰ç´« */
            --accent-soft: #c8b7c9;  /* è—•ç°è‰² */
            --bg-page: #fcfaff;
            --text-main: #332d35;
        }

        /* å„ªåŒ–å­—é«”é–±è®€æ€§ */
        body {
            background-color: var(--bg-page);
            color: var(--text-main);
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Microsoft JhengHei", "PingFang TC", sans-serif;
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
        }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
        
        .tab-content { display: none; animation: fadeIn 0.4s cubic-bezier(0.16, 1, 0.3, 1); }
        .tab-content.active { display: block; }

        /* å°è¦½åˆ—èˆ‡æ¨™ç±¤ */
        .nav-item.active { color: var(--primary); font-weight: 800; }
        .nav-item.active .nav-icon { transform: scale(1.15); color: var(--primary); }
        .nav-item.active .nav-dot { display: block; }
        
        .day-tab.active, .sub-tab.active { 
            background-color: var(--primary); 
            color: white; 
            box-shadow: 0 4px 12px rgba(94, 74, 111, 0.2);
        }

        /* å¼·åŒ–å¡ç‰‡å±¤æ¬¡ */
        .glass-card { 
            background: #ffffff; 
            border: 1px solid #ece8ef; 
            box-shadow: 0 4px 20px rgba(83, 74, 85, 0.04);
            border-radius: 24px;
        }
        
        .agenda-card {
            border-left: 6px solid var(--primary);
            transition: transform 0.2s;
        }
        
        .info-tag { 
            background-color: #f3f0f5; 
            font-size: 12px; 
            padding: 4px 10px; 
            border-radius: 8px; 
            color: var(--secondary);
            font-weight: 600;
        }

        .room-badge { 
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white; 
            padding: 4px 12px; 
            border-radius: 99px; 
            font-weight: 800; 
            font-size: 12px; 
            letter-spacing: 0.5px;
        }

        .section-title {
            font-size: 1.25rem;
            font-weight: 900;
            color: var(--primary);
            letter-spacing: -0.02em;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Sticky Header for Agenda */
        .agenda-section-header { 
            position: sticky; 
            top: 70px; 
            z-index: 20;
            background: rgba(252, 250, 255, 0.96);
            backdrop-filter: blur(10px);
            padding: 12px 0;
            margin: 0 -4px;
        }
    </style>
</head>
<body class="pb-32 max-w-md mx-auto shadow-2xl overflow-x-hidden min-h-screen">

    <!-- Header -->
    <header class="bg-white/95 backdrop-blur-md sticky top-0 z-50 px-5 py-3 flex items-center justify-between border-b border-gray-100 shadow-sm">
        <div class="flex items-center gap-3">
            <img src="https://i.meee.com.tw/AAiaMSR.png" alt="å°å¤§é†«é™¢ Logo" class="h-10 w-auto">
            <div class="flex flex-col">
                <span class="font-black text-[#534a55] text-base leading-tight tracking-tight">è‡ºå¤§é†«ç™‚é«”ç³»</span>
                <span class="text-[10px] text-[#5e4a6f] font-black uppercase tracking-widest">Workshop App</span>
            </div>
        </div>
        <div id="loading-spinner" class="hidden">
            <div class="w-5 h-5 border-3 border-[#5e4a6f] border-t-transparent rounded-full animate-spin"></div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="px-5 py-6">
        
        <!-- é¦–é  (Home) -->
        <div id="home" class="tab-content active">
            <div class="flex flex-col gap-6">
                <!-- Main Banner -->
                <div class="relative rounded-[2.5rem] p-8 shadow-xl overflow-hidden text-white" style="background: linear-gradient(135deg, #5e4a6f 0%, #3e3247 100%);">
                    <div class="relative z-10">
                        <div class="inline-block bg-white/20 backdrop-blur-md px-3 py-1 rounded-full text-[10px] font-bold tracking-widest mb-4 border border-white/30 uppercase">Annual Workshop 2026</div>
                        <h1 class="text-2xl font-black mb-6 leading-[1.3] tracking-tight">115å¹´åº¦è‡ºå¤§é†«ç™‚é«”ç³»<br/>æ–°é€²ä¸»æ²»é†«å¸«èˆ‡<br/>é†«äº‹äººå“¡ç ”ç©¶ç‡Ÿ</h1>
                        <div class="space-y-3 opacity-90 text-sm font-medium">
                            <div class="flex items-center gap-3">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><rect x="3" y="4" width="18" height="18" rx="2"></rect><line x1="3" y1="10" x2="21" y2="10"></line></svg>
                                <span>115å¹´3æœˆ6æ—¥ (äº”) - 3æœˆ7æ—¥ (å…­)</span>
                            </div>
                            <div class="flex items-center gap-3">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path></svg>
                                <span>å®œè˜­ç“å±±æ—è˜‡æ¾³åº¦å‡é£¯åº—</span>
                            </div>
                        </div>
                    </div>
                    <div class="absolute -right-12 -bottom-12 w-48 h-48 bg-white/10 rounded-full blur-3xl"></div>
                </div>

                <!-- Quick Navigation -->
                <div class="grid grid-cols-2 gap-4">
                    <button onclick="switchTab('agenda')" class="bg-white p-6 rounded-[2rem] shadow-sm border border-gray-100 flex flex-col items-center gap-4 active:scale-95 transition-all">
                        <div class="w-16 h-16 bg-[#d3b4d3]/20 text-[#5e4a6f] rounded-2xl flex items-center justify-center">
                            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2" stroke-linecap="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
                        </div>
                        <span class="font-black text-[#534a55] text-base">ç ”ç©¶ç‡Ÿè­°ç¨‹</span>
                    </button>
                    <button onclick="switchTab('search')" class="bg-white p-6 rounded-[2rem] shadow-sm border border-gray-100 flex flex-col items-center gap-4 active:scale-95 transition-all">
                        <div class="w-16 h-16 bg-[#c8b7c9]/20 text-[#534a55] rounded-2xl flex items-center justify-center">
                            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2" stroke-linecap="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle></svg>
                        </div>
                        <span class="font-black text-[#534a55] text-base">å­¸å“¡åå†Š</span>
                    </button>
                </div>

                <div class="bg-blue-50 border border-blue-100 p-5 rounded-3xl flex gap-4 text-sm text-blue-900 leading-relaxed shadow-sm">
                    <div class="w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center shrink-0 text-lg">ğŸ’¡</div>
                    <span class="font-bold pt-1">æº«é¦¨æç¤ºï¼šè«‹å…ˆæŸ¥é–±ã€Œè¡Œå‰ã€é é¢ï¼Œç¢ºèªé›†åˆè»Šæ¬¡ã€æ³¨æ„äº‹é …èˆ‡å·®å‡è¦å®šã€‚</span>
                </div>
            </div>
        </div>

        <!-- è­°ç¨‹ (Agenda) -->
        <div id="agenda" class="tab-content">
            <div class="flex gap-3 mb-8 bg-[#f0edf2] p-1.5 rounded-2xl shadow-inner">
                <button onclick="filterAgenda('Day1')" id="btn-day1" class="day-tab active flex-1 py-3.5 rounded-xl font-black text-sm tracking-widest transition-all">DAY 1</button>
                <button onclick="filterAgenda('Day2')" id="btn-day2" class="day-tab flex-1 py-3.5 rounded-xl font-black text-sm tracking-widest transition-all text-[#a397a5]">DAY 2</button>
            </div>
            <div id="agenda-list" class="space-y-10 pb-10">
                <div class="text-center text-[#c8b7c9] py-20 font-bold italic tracking-wider">æ­£åœ¨å¾é›²ç«¯è®€å–è­°ç¨‹...</div>
            </div>
        </div>

        <!-- åå†Š (Search) -->
        <div id="search" class="tab-content">
            <div class="flex gap-1 mb-6 border-b border-[#eee]">
                <button onclick="switchSearchSubTab('all')" id="subtab-all" class="sub-tab active px-6 py-3 font-black text-sm tracking-wide transition-all border-b-4 border-[#5e4a6f] text-[#5e4a6f]">å…¨éƒ¨åå–®</button>
                <button onclick="switchSearchSubTab('rooms')" id="subtab-rooms" class="sub-tab px-6 py-3 font-black text-sm tracking-wide transition-all border-b-4 border-transparent text-[#a397a5]">ä½å®¿åˆ†é…</button>
            </div>

            <div id="search-all-container">
                <div class="bg-white p-2 rounded-3xl shadow-sm border border-gray-100 mb-6 focus-within:ring-4 focus-within:ring-[#5e4a6f]/5 transition-all">
                    <div class="relative">
                        <input id="search-input" type="text" placeholder="æœå°‹å§“åæˆ–å“¡å·¥ç·¨è™Ÿ..." oninput="handleInstantSearch()" class="w-full pl-5 pr-14 py-4 rounded-2xl border-none outline-none text-base font-bold text-[#332d35] placeholder-[#c8b7c9]">
                        <div class="absolute right-5 top-1/2 -translate-y-1/2 text-[#5e4a6f]">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
                        </div>
                    </div>
                </div>
                <div class="px-2 mb-4 flex justify-between items-center text-xs font-black text-[#a397a5] uppercase tracking-widest">
                    <span>Master Participant List</span>
                    <span id="search-count" class="bg-gray-100 px-2 py-0.5 rounded">0 Results</span>
                </div>
                <div id="participant-list" class="space-y-5">
                    <div class="text-center text-[#c8b7c9] py-20 font-bold italic tracking-wider">æ­£åœ¨è¼‰å…¥åå†Šè³‡æ–™...</div>
                </div>
            </div>
            <div id="search-rooms-container" class="hidden space-y-4">
                <div id="accommodation-list" class="space-y-4"></div>
            </div>
        </div>

        <!-- è¡Œå‰ (Pre-departure) -->
        <div id="info" class="tab-content space-y-8">
            <h2 class="section-title px-2"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg> è¡Œå‰æŒ‡å—</h2>

            <div class="space-y-6">
                <!-- æ³¨æ„äº‹é … -->
                <div class="bg-white p-7 rounded-[2.5rem] border border-gray-100 shadow-sm">
                    <h3 class="font-black text-lg text-[#5e4a6f] mb-5 flex items-center gap-3">
                        <span class="w-1.5 h-6 bg-[#5e4a6f] rounded-full"></span> æ³¨æ„äº‹é …
                    </h3>
                    <ul class="space-y-4">
                        <li class="flex items-start gap-3"><span class="text-blue-600 font-black">01.</span> <span class="font-bold text-sm">è«‹æ”œå¸¶å¥ä¿å¡ã€å€‹äººéš¨èº«è—¥å“èˆ‡å€‹äººç›¥æ´—å‚™å“ã€‚</span></li>
                        <li class="flex items-start gap-3"><span class="text-blue-600 font-black">02.</span> <span class="font-bold text-sm">é£¯åº—æä¾›å†·ç†±æ³‰è¨­æ–½ï¼Œè«‹è‡ªå‚™æ³³è¡£æ³³å¸½ã€‚</span></li>
                        <li class="flex items-start gap-3"><span class="text-blue-600 font-black">03.</span> <span class="font-bold text-sm">èª²ç¨‹æœŸé–“è«‹å°‡æ‰‹æ©Ÿè½‰ç‚ºéœéŸ³ï¼Œæœƒå ´æä¾›å……é›»èˆ‡ Wifiã€‚</span></li>
                        <li class="flex items-start gap-3"><span class="text-blue-600 font-black">04.</span> <span class="font-bold text-sm">3 æœˆä»½å®œè˜­æ°£å€™å¤šè®Šï¼Œè«‹æ”œå¸¶é›¨å…·åŠä¿æš–è¡£ç‰©ã€‚</span></li>
                        <li class="flex items-start gap-3"><span class="text-blue-600 font-black">05.</span> <span class="font-bold text-sm">é™¢æ–¹æ ¸å‡†å…¬å‡å—è¨“ï¼Œä¸Šèª²èˆ‡çµè¨“é ˆä¾è¦å®šç°½åˆ°é€€ã€‚</span></li>
                    </ul>
                </div>

                <!-- è¡Œè»Šå®£å° -->
                <div class="bg-[#5e4a6f]/5 p-7 rounded-[2.5rem] border border-[#5e4a6f]/10 shadow-sm">
                    <h3 class="font-black text-lg text-[#5e4a6f] mb-4 flex items-center gap-2">ğŸšŒ è¡Œè»Šå®£å°</h3>
                    <div class="space-y-3">
                        <p class="text-sm font-bold leading-relaxed text-[#534a55] bg-white/50 p-3 rounded-xl border border-white">1. è«‹ä¾è»Šæ¬¡æ­ä¹˜ï¼Œå°‡æ–¼è»Šä¸Šç™¼æ”¾æˆ¿å¡èˆ‡è¡ŒæåŠç‰Œã€‚</p>
                        <p class="text-sm font-bold leading-relaxed text-[#534a55] bg-white/50 p-3 rounded-xl border border-white">2. å›ç¨‹äººæ»¿å³ç™¼è»Šï¼Œä¸‹è»Šé»ä¾ç•¶æ—¥è·¯æ³è€Œå®šã€‚</p>
                    </div>
                </div>

                <!-- å·®å‡è¦å®š -->
                <div class="bg-gray-50 p-7 rounded-[2.5rem] border border-gray-100 shadow-sm">
                    <h3 class="font-black text-lg text-[#534a55] mb-5 flex items-center gap-2">ğŸ“„ å·®å‡è¦å®š</h3>
                    <div class="space-y-6">
                        <div class="relative pl-4 border-l-4 border-[#c8b7c9]">
                            <span class="text-[10px] font-black text-[#a397a5] tracking-widest block mb-1 uppercase">ä¸Šç­æ™‚é–“å—è¨“</span>
                            <p class="text-sm font-bold text-[#534a55]">åƒè¨“äººå“¡å—è¨“æœŸé–“å¦‚é‡ä¸Šç­æ™‚é–“ï¼Œä¾è¦å®šæ ¸äºˆå…¬å‡å‰å¾€ã€‚</p>
                        </div>
                        <div class="relative pl-4 border-l-4 border-[#c8b7c9]">
                            <span class="text-[10px] font-black text-[#a397a5] tracking-widest block mb-1 uppercase">éä¸Šç­æ™‚é–“å—è¨“</span>
                            <p class="text-sm font-bold text-[#534a55]">å¦‚æ–¼éä¸Šç­æ™‚é–“å—è¨“å‰‡ä»¥å¯¦éš›åƒè¨“æ™‚æ•¸è¾¦ç†å…¬å‡è£œä¼‘ã€‚</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- æœƒå¾Œ (Post-event) -->
        <div id="post" class="tab-content space-y-8">
            <h2 class="section-title px-2"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path></svg> æœƒå¾Œç´€éŒ„</h2>
            
            <div class="bg-white p-8 rounded-[2.5rem] shadow-sm border border-gray-100">
                <span class="text-[10px] font-black text-[#a397a5] tracking-widest uppercase mb-2 block">Survey</span>
                <h3 class="font-black text-xl text-[#5e4a6f] mb-4">æ»¿æ„åº¦èª¿æŸ¥å•å·</h3>
                <p class="text-sm font-bold text-[#534a55] mb-8 leading-relaxed">
                    æ„Ÿè¬æ‚¨çš„åƒèˆ‡ï¼æ‚¨çš„å›é¥‹èˆ‡å»ºè­°å°‡å¹«åŠ©æˆ‘å€‘å°‡æœªä¾†çš„ç ”ç©¶ç‡Ÿè¾¦å¾—æ›´å¥½ã€‚
                </p>
                <a href="https://medresearchntuh.github.io/20260307_115/" target="_blank" class="block w-full py-5 bg-[#5e4a6f] text-white text-center rounded-2xl font-black shadow-lg active:scale-95 transition-all text-base tracking-widest uppercase">
                    ç«‹å³å¡«å¯«å•å·
                </a>
            </div>

            <div class="bg-[#f0edf2]/50 p-8 rounded-[2.5rem] border border-[#ece8ef] border-dashed text-center">
                <div class="w-16 h-16 bg-white rounded-full flex items-center justify-center mx-auto mb-4 shadow-sm">
                    <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="#c8b7c9" stroke-width="2.5"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path><circle cx="12" cy="13" r="4"></circle></svg>
                </div>
                <h3 class="font-black text-[#534a55] mb-2">æ´»å‹•ç…§ç‰‡ä¸‹è¼‰å€</h3>
                <p class="text-xs font-bold text-gray-400 italic leading-relaxed">çµè¨“å¾Œ 2 é€±å·¥ä½œå¤©å…§ä¸Šå‚³ç…§ç‰‡ï¼Œå±†æ™‚ç³»çµ±å°‡é–‹æ”¾ä¸‹è¼‰é€£çµã€‚</p>
            </div>
        </div>

    </main>

    <!-- Bottom Navigation -->
    <nav class="fixed bottom-0 left-1/2 -translate-x-1/2 w-full max-w-md bg-white/95 backdrop-blur-lg border-t border-gray-100 px-2 py-5 flex justify-between items-center z-50 shadow-[0_-10px_30px_rgba(0,0,0,0.05)] rounded-t-[2.5rem]">
        <button onclick="switchTab('home')" class="nav-item active flex flex-col items-center gap-1.5 transition-all flex-1" data-tab="home">
            <svg class="nav-icon" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path></svg>
            <span class="text-[10px] font-black">é¦–é </span>
            <div class="nav-dot hidden w-1 h-1 bg-[#5e4a6f] rounded-full mt-0.5 mx-auto"></div>
        </button>
        <button onclick="switchTab('agenda')" class="nav-item flex flex-col items-center gap-1.5 transition-all text-[#c8b7c9] flex-1" data-tab="agenda">
            <svg class="nav-icon" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
            <span class="text-[10px] font-black">è­°ç¨‹</span>
            <div class="nav-dot hidden w-1 h-1 bg-[#5e4a6f] rounded-full mt-0.5 mx-auto"></div>
        </button>
        <button onclick="switchTab('search')" class="nav-item flex flex-col items-center gap-1.5 transition-all text-[#c8b7c9] flex-1" data-tab="search">
            <svg class="nav-icon" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle></svg>
            <span class="text-[10px] font-black">åå†Š</span>
            <div class="nav-dot hidden w-1 h-1 bg-[#5e4a6f] rounded-full mt-0.5 mx-auto"></div>
        </button>
        <button onclick="switchTab('info')" class="nav-item flex flex-col items-center gap-1.5 transition-all text-[#c8b7c9] flex-1" data-tab="info">
            <svg class="nav-icon" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><path d="M9 11l3 3L22 4"></path><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path></svg>
            <span class="text-[10px] font-black">è¡Œå‰</span>
            <div class="nav-dot hidden w-1 h-1 bg-[#5e4a6f] rounded-full mt-0.5 mx-auto"></div>
        </button>
        <button onclick="switchTab('post')" class="nav-item flex flex-col items-center gap-1.5 transition-all text-[#c8b7c9] flex-1" data-tab="post">
            <svg class="nav-icon" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path></svg>
            <span class="text-[10px] font-black">æœƒå¾Œ</span>
            <div class="nav-dot hidden w-1 h-1 bg-[#5e4a6f] rounded-full mt-0.5 mx-auto"></div>
        </button>
    </nav>

    <!-- Modal (Profile Detail) -->
    <div id="modal" class="hidden fixed inset-0 z-[100] flex items-end justify-center bg-[#1a161c]/60 backdrop-blur-md animate-in fade-in duration-300 px-4">
        <div class="bg-white w-full max-w-md rounded-[2.5rem] p-9 max-h-[85vh] overflow-y-auto shadow-2xl animate-in slide-in-from-bottom-12 duration-500 mb-4">
            <div class="flex justify-between items-start mb-8">
                <div>
                    <h2 id="modal-name" class="text-3xl font-black text-[#332d35] tracking-tight">å§“å</h2>
                    <p id="modal-id" class="text-xs font-black text-[#a397a5] mt-2 tracking-widest uppercase font-mono">Employee ID: 000000</p>
                </div>
                <button onclick="closeModal()" class="p-3 bg-gray-100 rounded-2xl text-[#332d35] hover:bg-gray-200 transition-colors">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                </button>
            </div>
            <div id="modal-content" class="space-y-1"></div>
            <button onclick="closeModal()" class="w-full mt-10 py-5 bg-[#5e4a6f] text-white font-black rounded-2xl shadow-lg active:scale-95 transition-all tracking-widest uppercase">Close Profile</button>
        </div>
    </div>

    <script>
        // --- é…ç½®å€ ---
        const GAS_WEB_APP_URL = "https://script.google.com/macros/s/AKfycbzFO8lChUB9zL0nJY3nOXT2TSP_rTpsnIci1C-1dtYUeKMeOfBhzsEJW1MSbEOWuOBP9Q/exec";

        let allAgenda = [];
        let allParticipants = [];

        async function fetchData(action) {
            if (!GAS_WEB_APP_URL) return [];
            document.getElementById('loading-spinner').classList.remove('hidden');
            try {
                const response = await fetch(`${GAS_WEB_APP_URL}?action=${action}`);
                const data = await response.json();
                return data;
            } catch (error) {
                console.error("Fetch Error:", error);
                return [];
            } finally {
                document.getElementById('loading-spinner').classList.add('hidden');
            }
        }

        async function switchTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            
            document.querySelectorAll('.nav-item').forEach(el => {
                if (el.dataset.tab === tabId) el.classList.add('active');
                else el.classList.remove('active');
            });
            
            if (tabId === 'agenda' && allAgenda.length === 0) await loadAgenda();
            if (tabId === 'search' && allParticipants.length === 0) await loadParticipants();
            window.scrollTo(0, 0);
        }

        async function loadAgenda() {
            allAgenda = await fetchData('getAgenda');
            filterAgenda('Day1');
        }

        function filterAgenda(day) {
            const list = document.getElementById('agenda-list');
            document.getElementById('btn-day1').classList.toggle('active', day === 'Day1');
            document.getElementById('btn-day2').classList.toggle('active', day === 'Day2');
            
            const filtered = allAgenda.filter(item => item.Day === day);
            if (filtered.length === 0) {
                list.innerHTML = `<div class="text-center text-[#c8b7c9] py-20 font-bold italic">é›²ç«¯å°šç„¡è­°ç¨‹è³‡æ–™</div>`;
                return;
            }

            // æŒ‰ Section åˆ†çµ„
            const sections = [];
            filtered.forEach(item => {
                let section = sections.find(s => s.name === item.Section);
                if (!section) {
                    section = { name: item.Section, moderator: item.Moderator, moderatorDept: item.ModeratorDept, items: [] };
                    sections.push(section);
                }
                section.items.push(item);
            });

            list.innerHTML = sections.map(sec => `
                <div class="space-y-6">
                    <div class="agenda-section-header flex flex-col gap-1 border-b-2 border-[#5e4a6f]/20 pb-2">
                        <div class="flex items-center gap-3">
                            <span class="w-2 h-6 bg-[#5e4a6f] rounded-full"></span>
                            <h3 class="font-black text-[#5e4a6f] text-base tracking-wide uppercase">${sec.name}</h3>
                        </div>
                        ${sec.moderator ? `
                            <div class="flex flex-wrap items-center gap-2 mt-2">
                                <span class="text-[10px] bg-[#d3b4d3]/30 px-2 py-0.5 rounded-lg border border-[#d3b4d3]/50 font-black text-[#5e4a6f] tracking-tight">ä¸»æŒå–®ä½: ${sec.moderatorDept || '--'}</span>
                                <span class="text-xs font-black text-[#534a55] italic tracking-tight">ä¸»æŒäºº: ${sec.moderator}</span>
                            </div>
                        ` : ''}
                    </div>
                    <div class="space-y-5">
                        ${sec.items.map(item => `
                            <div class="bg-white p-6 rounded-3xl border border-[#ece8ef] shadow-sm animate-in fade-in slide-in-from-left-4 agenda-card">
                                <div class="text-[11px] font-black text-[#5e4a6f]/70 mb-2 uppercase tracking-widest">${item.Time}</div>
                                <div class="font-black text-[#332d35] text-lg leading-snug mb-3">${item.Title}</div>
                                ${item.Speaker ? `
                                    <div class="flex flex-wrap items-center gap-2 mb-2">
                                        <span class="bg-[#5e4a6f] text-white px-2 py-0.5 rounded text-[9px] font-black uppercase tracking-wider">Speaker</span>
                                        <div class="flex items-center gap-2">
                                            <span class="text-[11px] font-black text-[#a397a5] bg-gray-50 px-1.5 py-0.5 rounded border border-gray-100">[${item.SpeakerDept || 'å–®ä½å¾…å®š'}]</span>
                                            <span class="text-sm font-bold text-[#332d35] underline underline-offset-4 decoration-2 decoration-[#d3b4d3]">${item.Speaker}</span>
                                        </div>
                                    </div>
                                ` : ''}
                                ${item.Location ? `<div class="mt-4 text-[11px] text-[#a397a5] flex items-center gap-2 font-black uppercase tracking-tighter"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path></svg>${item.Location}</div>` : ''}
                            </div>
                        `).join('')}
                    </div>
                </div>
            `).join('');
        }

        async function loadParticipants() {
            allParticipants = await fetchData('getParticipants');
            renderParticipants(allParticipants);
        }

        function renderParticipants(data) {
            const list = document.getElementById('participant-list');
            document.getElementById('search-count').innerText = `${data.length} Results`;
            if (data.length === 0) {
                list.innerHTML = `<div class="text-center text-[#c8b7c9] py-20 font-bold italic tracking-widest">ç„¡ç¬¦åˆæ¢ä»¶çš„åå–®</div>`;
                return;
            }
            list.innerHTML = data.map(p => `
                <div onclick="showDetail('${p.å“¡å·¥ç·¨è™Ÿ}')" class="bg-white p-6 rounded-[2.5rem] border border-[#ece8ef] shadow-sm active:scale-[0.98] transition-all cursor-pointer">
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <span class="font-black text-[#332d35] text-xl tracking-tight">${p.å§“å}</span>
                            <span class="text-[11px] text-[#a397a5] ml-2 font-black tracking-widest uppercase font-mono">${p.å“¡å·¥ç·¨è™Ÿ || ''}</span>
                        </div>
                        <span class="room-badge shadow-sm">${p.æˆ¿è™Ÿ === 'ä¸ä½å®¿' ? 'ç„¡ä½å®¿' : p.æˆ¿è™Ÿ}</span>
                    </div>
                    <div class="flex flex-wrap gap-2 pt-4 border-t border-dashed border-[#f0edf2]">
                        <span class="info-tag shadow-sm">ğŸšŒ ${p.äº¤é€šè»Š || '--'}</span>
                        <span class="info-tag shadow-sm">ğŸ½ï¸ ${p.ç”¨é¤ || '--'}</span>
                        <span class="info-tag shadow-sm">ğŸ¥¦ ${p.è‘·ç´  || '--'}</span>
                    </div>
                </div>
            `).join('');
        }

        function switchSearchSubTab(sub) {
            document.querySelectorAll('.sub-tab').forEach(el => {
                el.classList.remove('active', 'border-[#5e4a6f]', 'text-[#5e4a6f]');
                el.classList.add('border-transparent', 'text-[#a397a5]');
            });
            document.getElementById(`subtab-${sub}`).classList.add('active', 'border-[#5e4a6f]', 'text-[#5e4a6f]');
            
            if (sub === 'all') {
                document.getElementById('search-all-container').classList.remove('hidden');
                document.getElementById('search-rooms-container').classList.add('hidden');
                renderParticipants(allParticipants);
            } else {
                document.getElementById('search-all-container').classList.add('hidden');
                document.getElementById('search-rooms-container').classList.remove('hidden');
                renderAccommodationList();
            }
        }

        function renderAccommodationList() {
            const list = document.getElementById('accommodation-list');
            const roomList = allParticipants
                .filter(p => p.æˆ¿è™Ÿ && p.æˆ¿è™Ÿ !== 'ä¸ä½å®¿' && p.æˆ¿è™Ÿ !== '--')
                .sort((a, b) => String(a.æˆ¿è™Ÿ).localeCompare(String(b.æˆ¿è™Ÿ)));

            if (roomList.length === 0) {
                list.innerHTML = `<div class="text-center text-[#c8b7c9] py-20 font-bold italic tracking-widest">ç›®å‰ç„¡ä½å®¿åˆ†é…è³‡æ–™</div>`;
                return;
            }

            list.innerHTML = roomList.map(p => `
                <div onclick="showDetail('${p.å“¡å·¥ç·¨è™Ÿ}')" class="bg-white p-5 rounded-3xl border border-[#ece8ef] shadow-sm flex items-center justify-between active:bg-gray-50 transition-colors">
                    <div class="flex items-center gap-5">
                        <div class="w-12 h-12 rounded-2xl bg-[#5e4a6f] text-white flex flex-col items-center justify-center font-black shadow-md">
                            <span class="text-[8px] opacity-70 uppercase mb-0.5">Room</span>
                            <span class="text-sm tracking-tighter font-mono">${p.æˆ¿è™Ÿ}</span>
                        </div>
                        <div>
                            <p class="font-black text-[#332d35] text-lg">${p.å§“å}</p>
                            <p class="text-[10px] text-[#a397a5] font-black uppercase tracking-widest">${p.å“¡å·¥ç·¨è™Ÿ}</p>
                        </div>
                    </div>
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#c8b7c9" stroke-width="3"><polyline points="9 18 15 12 9 6"></polyline></svg>
                </div>
            `).join('');
        }

        function handleInstantSearch() {
            const val = document.getElementById('search-input').value.toLowerCase();
            const filtered = allParticipants.filter(p => 
                (p.å§“å && p.å§“å.toLowerCase().includes(val)) || 
                (p.å“¡å·¥ç·¨è™Ÿ && String(p.å“¡å·¥ç·¨è™Ÿ).toLowerCase().includes(val))
            );
            renderParticipants(filtered);
        }

        function showDetail(id) {
            const p = allParticipants.find(item => item.å“¡å·¥ç·¨è™Ÿ == id);
            if (!p) return;
            document.getElementById('modal-name').innerText = p.å§“å;
            document.getElementById('modal-id').innerText = `Employee ID: ${p.å“¡å·¥ç·¨è™Ÿ || '--'}`;
            
            const fields = [
                { label: 'èº«åˆ†', key: 'èº«åˆ†' },
                { label: 'é™¢åˆ¥', key: 'é™¢åˆ¥' },
                { label: 'ç§‘éƒ¨åˆ¥', key: 'ç§‘éƒ¨åˆ¥' },
                { label: 'è·ç¨±', key: 'è·ç¨±' },
                { label: 'äº¤é€šå®‰æ’', key: 'äº¤é€šè»Š' },
                { label: 'æˆ¿è™Ÿ', key: 'æˆ¿è™Ÿ' },
                { label: 'ç”¨é¤å®‰æ’', key: 'ç”¨é¤' },
                { label: 'æ™šå®´æ¡Œæ¬¡', key: 'æ™šå®´æ¡Œæ¬¡' },
                { label: 'è‘·ç´ ç¿’æ…£', key: 'è‘·ç´ ' },
                { label: 'è¡£æœå°ºå¯¸', key: 'è¡£æœå°ºå¯¸' },
                { label: 'è£œå·®é¡', key: 'è£œå·®é¡' }
            ];

            document.getElementById('modal-content').innerHTML = fields.map(f => `
                <div class="detail-row flex justify-between items-center py-4 border-b border-[#f9f8fa]">
                    <span class="text-[#a397a5] font-black text-xs tracking-widest uppercase">${f.label}</span>
                    <span class="text-[#332d35] font-black text-base">${p[f.key] || '--'}</span>
                </div>
            `).join('');
            document.getElementById('modal').classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        function closeModal() {
            document.getElementById('modal').classList.add('hidden');
            document.body.style.overflow = '';
        }

        window.onload = async () => {
            // åˆæ¬¡è‡ªå‹•è¼‰å…¥åå†Šï¼ˆå¯æ ¹æ“šéœ€æ±‚èª¿æ•´ç‚ºé»æ“Šæ‰è¼‰å…¥ï¼‰
            await switchTab('home');
        };
    </script>
</body>
</html>
